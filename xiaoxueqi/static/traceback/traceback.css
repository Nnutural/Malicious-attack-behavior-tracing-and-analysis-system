/* =========================================================
   页面整体：左右边距一致、左右都尽量铺满
   ========================================================= */

/* 关键：让页面内容居中且左右边距一致 */
.tb-page{
  max-width: 1700px;  /* 更宽一点，图不显得窄 */
  margin: 0 auto;     /* 居中 */
  padding: 12px 18px; /* 左右边距一致 */
}

.tb-header{
  display:flex;
  justify-content:space-between;
  gap:16px;
  align-items:flex-start;
  margin-bottom: 12px;
}

.tb-subtitle{ color:#666; font-size: 13px; margin-top: 4px; }

.tb-toolbar{
  display:flex;
  gap:10px;
  align-items:center;
  flex-wrap:wrap;
  justify-content:flex-end;
}

.tb-status{
  color:#666;
  font-size:12px;
  min-width: 180px;
  text-align:right;
}

/* =========================
   按钮
   ========================= */
.btn{
  border:1px solid #d0d0d0;
  background:#fff;
  color:#111;
  padding: 8px 12px;
  border-radius: 10px;
  cursor:pointer;
}
.btn:hover{ background:#f5f5f5; }

.btn-secondary{
  background:#2b2f36;
  border-color:#2b2f36;
  color:#fff;
}
.btn-secondary:hover{
  background:#1f2329;
  border-color:#1f2329;
  color:#fff;
}

.btn-primary{
  background:#111;
  color:#fff;
  border-color:#111;
}
.btn-primary:hover{ background:#222; }

.switch{
  display:flex;
  gap:6px;
  align-items:center;
  border:1px solid #eee;
  padding: 6px 10px;
  border-radius: 999px;
  font-size: 12px;
  color:#333;
  background:#fff;
}
.switch input{ transform: translateY(1px); }

/* =========================================================
   主布局：左侧固定更靠左（sticky），右侧内容固定宽度区域
   ========================================================= */
.tb-layout{
  display:grid;
  grid-template-columns: 420px 1fr;
  gap: 16px;
  align-items:start;
}

/* 左侧更靠左固定：sticky */
.tb-left{
  position: sticky;
  top: 12px;
  align-self: start;
}

/* 右侧内容避免“拉满导致过宽不好读”，同时保证整体左右边距一致 */
.tb-right{
  min-width: 0; /* 防止网格溢出 */
}

/* 通用 panel */
.panel{
  border: 1px solid #e9e9e9;
  border-radius: 12px;
  background:#fff;
  padding: 12px;
}
.panel-title{
  font-weight: 700;
  margin-bottom: 10px;
}

.muted{ color:#666; font-size: 12px; }

/* 告警列表卡片 */
.alert-list{ display:flex; flex-direction:column; gap:10px; }

.alert-card{
  border:1px solid #eee;
  border-radius: 12px;
  padding:10px;
  cursor:pointer;
  background:#fff;
}
.alert-card:hover{ border-color:#dcdcdc; background:#fafafa; }
.alert-card.active{ border-color:#111; box-shadow: 0 0 0 2px rgba(17,17,17,0.08); }

.alert-top{ display:flex; justify-content:space-between; gap:10px; align-items:center; }

.badge{ font-size: 12px; padding:2px 8px; border-radius: 999px; border:1px solid #eee; }
.badge-high{ background:#ffe8e8; border-color:#ffb7b7; color:#a00000; }
.alert-time{ color:#666; font-size: 12px; }
.alert-main{ margin-top:6px; font-size: 13px; }
.alert-sub{ margin-top:4px; color:#666; font-size: 12px; }

/* 概览卡片 */
.summary-grid{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
}
.card{
  border:1px solid #eee;
  border-radius: 12px;
  padding: 10px;
  background:#fff;
}
.card-title{ font-weight:700; margin-bottom: 6px; }
.card-body{ color:#222; font-size: 13px; }

.kv{ display:grid; grid-template-columns: 120px 1fr; gap: 6px; }
.kv .k{ color:#666; }
.kv .v{ color:#111; word-break: break-word; }

/* Tabs */
.tabs{ display:flex; gap:8px; flex-wrap:wrap; margin-bottom: 10px; }
.tab{
  padding: 7px 10px;
  border:1px solid #ddd;
  border-radius: 10px;
  background:#fff;
  cursor:pointer;
  font-size: 13px;
}
.tab.active{ background:#111; color:#fff; border-color:#111; }

.tab-content{ display:none; }
.tab-content.active{ display:block; }

/* =========================================================
   图谱区域：图例横排在上、图在中、详情在下
   ========================================================= */
.graph-legend-row{
  display:flex;
  flex-wrap:wrap;
  gap: 10px 14px;
  align-items:center;
  margin-bottom: 10px;
  padding: 8px 10px;
  border:1px solid #eee;
  border-radius: 12px;
  background: #fafafa;
  font-size: 12px;
  color:#333;
}
.legend-item{ display:flex; align-items:center; gap:6px; }

.graph{
  height: 640px;            /* 更大一点 */
  border:1px solid #eee;
  border-radius: 12px;
  background:#fff;
}

.graph-detail{
  margin-top: 12px;
}
.graph-detail pre{
  background:#f7f7f7;
  color:#111;            /* 新增：详情文字改为黑色，提升对比度 */
  padding:10px;
  border-radius: 12px;
  overflow:auto;
  max-height: 260px;
}

/* 图例点 */
.dot{
  width:10px; height:10px;
  display:inline-block;
  border-radius:999px;
}
.dot-attack { background:#ffb3b3; border:1px solid #ff6666; }
.dot-tech { background:#fff2cc; border:1px solid #e6b800; }
.dot-proc { background:#eaeaea; border:1px solid #666; }
.dot-file { background:#f0e6ff; border:1px solid #8a63d2; }
.dot-user { background:#ffffff; border:1px solid #333; }
.dot-ip { background:#ddeeff; border:1px solid #6699ff; }
.dot-domain { background:#e6f7ff; border:1px solid #00a3cc; }

/* =========================================================
   [新增修复] AI 研判报告区域：绝不横向滚动，强制换行（包括代码块）
   说明：
   - AI 报告是 marked.js 渲染的 Markdown，常见超长内容：hash/url/base64/json/命令
   - 目标：任何情况下都不出现横向滚动条，永远不撑破右侧边界
   ========================================================= */
#aiReportBox{
  max-width: 100%;
  overflow-x: hidden;          /* 关键：禁止横向滚动 */
  overflow-y: visible;
  overflow-wrap: anywhere;     /* 关键：长串任意断行 */
  word-break: break-word;      /* 兼容旧浏览器 */
  line-break: anywhere;
}

/* Markdown 代码块 pre：也强制折行（不允许横向滚动） */
#aiReportBox pre{
  max-width: 100%;
  overflow-x: hidden;          /* 禁止代码块横向滚动 */
  white-space: pre-wrap;       /* 保留换行 + 允许自动换行 */
  word-break: break-word;
  overflow-wrap: anywhere;
}

/* 行内 code：hash/base64 也要折行 */
#aiReportBox code{
  max-width: 100%;
  white-space: pre-wrap;
  word-break: break-word;
  overflow-wrap: anywhere;
}

/* 超长链接（IOC 域名/URL）允许断开 */
#aiReportBox a{
  word-break: break-all;
  overflow-wrap: anywhere;
}

/* 段落/列表兜底 */
#aiReportBox p,
#aiReportBox li{
  max-width: 100%;
  overflow-wrap: anywhere;
  word-break: break-word;
}

/* 小屏适配 */
@media (max-width: 1100px){
  .tb-page{ max-width: 100%; padding: 12px; }
  .tb-layout{ grid-template-columns: 1fr; }
  .tb-left{ position: static; }
  .summary-grid{ grid-template-columns: 1fr; }
  .graph{ height: 520px; }
}