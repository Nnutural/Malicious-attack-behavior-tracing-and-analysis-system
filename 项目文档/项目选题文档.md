## 项目选题文档

---

### 题目 2：基于主机日志、主机行为、网络流量的恶意攻击行为溯源分析系统设计与实现

#### （1）完成主机日志、主机行为、网络流量等多源数据采集与融合

##### 主机日志采集与分析：

* 1)日志的时间序列对齐，统一不同主机和设备的时钟源，确保事件时间准确性；

* 2)日志范式解析：将不同格式的日志转换为统一范式；

* 3)关键信息提取：识别日志中的关键实体（用户、进程、文件、注册表键值）;

* 4)登录会话重建：通过登录/注销事件重建用户会话时间线和源 IP。

##### 主机行为监控：

* 1）系统调用拦截：在内核层监控所有系统调用，捕获文件、进程、网络操作；

* 2）进程行为链分析：构建进程父子关系树，识别异常进程创建模式；

* 3）文件操作监控：监控文件创建、修改、删除、读取操作，检测敏感文件访问；

* 4）内存行为分析：检测进程内存中的异常代码注入和反射加载。

##### 网络流量分析：

* 完成流量捕获与解析、异常协议行为建模、网络会话重建、隐蔽信道检测（识别 DNS 隧道、HTTP 隐蔽信道、ICMP 隧道等）。

#### （2）完成攻击链的检测与关联分析

* 基于 ATT&CK 框架的攻击链识别，将检测到的事件映射到 ATT&CK 的不同阶段；
* 识别同一攻击者使用的多个技术之间的逻辑关系；
* 与已知 APT 组织的攻击剧本进行相似性匹配。多源数据时间线关联分析，通过在特定时间窗口内聚合相关事件，基于时间先后和逻辑关系推断事件因果关系，从而识别攻击各阶段的时间间隔和模式。
* 实体关系图构建，从日志和流量中抽取实体并建立链接关系。

#### （3）攻击溯源关键技术

* 攻击路径重建，首先，通过边界设备日志识别初始入侵点；
* 其次，基于认证日志和网络连接追踪攻击者在内网的移动路径；
* 最后，分析权限提升路径分析，发现跟踪数据从存储到外传的完整路径。攻击者身份溯源，从攻击工具、脚本、配置文件中提取攻击者指纹特征，分析攻击者和C2 服务器的基础设施关联信息，包括分析 C2 服务器的注册信息、历史记录、关联域名等；开展行为模式分析和组织特征匹配，与已知 APT 组织的 TTP 进行匹配分析。

#### （4）测试环境：

* 搭建包含不少于 5 个节点的靶场环境，在靶场环境中，开展主机日志、主机行为、网络流量等多源数据采集下的恶意攻击行为溯源分析结果验证。

可参考的设计实现思路（无标准答案）：

<img src="C:\Users\wangm\AppData\Roaming\Typora\typora-user-images\image-20260112124550957.png" alt="image-20260112124550957" style="zoom:67%;" />